---
title: 'ä»¥å¤ªåŠæ¶æ„å®Œå…¨æŒ‡å—'
date: '2025-11-03'
excerpt: 'ä»¥å¤ªåŠæ¶æ„å®Œå…¨æŒ‡å—'
tags: ['Web3']
series: 'Web3å­¦ä¹ '
---

# ä»¥å¤ªåŠæ¶æ„å®Œå…¨æŒ‡å—

## ç›®å½•

- [ä»€ä¹ˆæ˜¯ä»¥å¤ªåŠ](#ä»€ä¹ˆæ˜¯ä»¥å¤ªåŠ)
- [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
- [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#æ ¸å¿ƒç»„ä»¶è¯¦è§£)
- [èŠ‚ç‚¹ç±»å‹ä¸ç½‘ç»œå±‚](#èŠ‚ç‚¹ç±»å‹ä¸ç½‘ç»œå±‚)
- [çŠ¶æ€ä¸å­˜å‚¨æœºåˆ¶](#çŠ¶æ€ä¸å­˜å‚¨æœºåˆ¶)
- [å…±è¯†æœºåˆ¶](#å…±è¯†æœºåˆ¶)
- [å®è·µç»ƒä¹ ](#å®è·µç»ƒä¹ )
- [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

---

## ä»€ä¹ˆæ˜¯ä»¥å¤ªåŠï¼Ÿ

### 1. ç®€å•å®šä¹‰

**ä»¥å¤ªåŠçš„æœ¬è´¨ï¼š**

```
ä»¥å¤ªåŠ = å»ä¸­å¿ƒåŒ–çš„ä¸–ç•Œè®¡ç®—æœº
       = åŒºå—é“¾ + æ™ºèƒ½åˆçº¦å¹³å°
       = å…¨çƒåˆ†å¸ƒå¼çŠ¶æ€æœº
       = å¯ç¼–ç¨‹çš„ä»·å€¼ç½‘ç»œ
```

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**

- ğŸŒ **å»ä¸­å¿ƒåŒ–**ï¼šå…¨çƒæ•°åƒèŠ‚ç‚¹å…±åŒç»´æŠ¤ï¼Œæ— å•ç‚¹æ•…éšœ
- ğŸ’» **å›¾çµå®Œå¤‡**ï¼šå¯ä»¥æ‰§è¡Œä»»æ„å¤æ‚çš„è®¡ç®—é€»è¾‘
- ğŸ”’ **ä¸å¯ç¯¡æ”¹**ï¼šä¸€æ—¦éƒ¨ç½²ï¼Œä»£ç å’Œæ•°æ®æ°¸ä¹…ä¿å­˜
- ğŸŒ **æ— éœ€è®¸å¯**ï¼šä»»ä½•äººéƒ½å¯ä»¥å‚ä¸ï¼Œæ— éœ€æ‰¹å‡†
- ğŸ’° **å¯ç¼–ç¨‹è´§å¸**ï¼šåŸç”Ÿæ”¯æŒæ™ºèƒ½åˆçº¦å’Œä»£å¸

### 2. ä»¥å¤ªåŠ vs æ¯”ç‰¹å¸

| ç‰¹æ€§     | æ¯”ç‰¹å¸     | ä»¥å¤ªåŠ             |
| -------- | ---------- | ------------------ |
| ä¸»è¦ç”¨é€” | æ•°å­—é»„é‡‘   | ä¸–ç•Œè®¡ç®—æœº         |
| æ™ºèƒ½åˆçº¦ | æœ‰é™       | å›¾çµå®Œå¤‡           |
| å…±è¯†æœºåˆ¶ | PoW        | PoS                |
| åŒºå—æ—¶é—´ | ~10 åˆ†é’Ÿ   | ~12 ç§’             |
| ç¼–ç¨‹è¯­è¨€ | Script     | Solidity, Vyper ç­‰ |
| åº”ç”¨åœºæ™¯ | æ”¯ä»˜ã€å‚¨å€¼ | DeFi, NFT, DApp ç­‰ |

---

## æ•´ä½“æ¶æ„

### 1. æ¶æ„å±‚çº§æ¦‚è§ˆ

```mermaid
graph TB
    A[åº”ç”¨å±‚ - DApps & Wallets] --> B[æ™ºèƒ½åˆçº¦å±‚ - Solidity/Vyper]
    B --> C[æ‰§è¡Œå±‚ - EVM]
    C --> D[å…±è¯†å±‚ - Beacon Chain]
    D --> E[ç½‘ç»œå±‚ - P2Pé€šä¿¡]
    E --> F[å­˜å‚¨å±‚ - åŒºå—é“¾æ•°æ®]

    style A fill:#e1f5ff
    style B fill:#b3e5fc
    style C fill:#81d4fa
    style D fill:#4fc3f7
    style E fill:#29b6f6
    style F fill:#039be5
```

**å±‚çº§è¯´æ˜ï¼š**

#### åº”ç”¨å±‚ (Application Layer)

```
ç”¨æˆ·ç›´æ¥æ¥è§¦çš„å±‚é¢
â”œâ”€â”€ DAppsï¼ˆå»ä¸­å¿ƒåŒ–åº”ç”¨ï¼‰
â”‚   â”œâ”€â”€ Uniswapï¼ˆDEXï¼‰
â”‚   â”œâ”€â”€ Aaveï¼ˆå€Ÿè´·ï¼‰
â”‚   â””â”€â”€ OpenSeaï¼ˆNFTå¸‚åœºï¼‰
â”œâ”€â”€ é’±åŒ…
â”‚   â”œâ”€â”€ MetaMask
â”‚   â”œâ”€â”€ Rainbow
â”‚   â””â”€â”€ Ledger
â””â”€â”€ å¼€å‘å·¥å…·
    â”œâ”€â”€ Hardhat
    â”œâ”€â”€ Foundry
    â””â”€â”€ Remix IDE
```

#### æ™ºèƒ½åˆçº¦å±‚ (Smart Contract Layer)

```
ç¼–ç¨‹æ¥å£å±‚
â”œâ”€â”€ é«˜çº§è¯­è¨€
â”‚   â”œâ”€â”€ Solidityï¼ˆæœ€æµè¡Œï¼‰
â”‚   â”œâ”€â”€ Vyperï¼ˆå®‰å…¨å¯¼å‘ï¼‰
â”‚   â””â”€â”€ Huffï¼ˆä½çº§ä¼˜åŒ–ï¼‰
â”œâ”€â”€ ç¼–è¯‘å™¨
â”‚   â””â”€â”€ æºä»£ç  â†’ å­—èŠ‚ç 
â””â”€â”€ æ ‡å‡†åº“
    â”œâ”€â”€ ERC-20ï¼ˆä»£å¸æ ‡å‡†ï¼‰
    â”œâ”€â”€ ERC-721ï¼ˆNFTæ ‡å‡†ï¼‰
    â””â”€â”€ ERC-1155ï¼ˆå¤šä»£å¸æ ‡å‡†ï¼‰
```

#### æ‰§è¡Œå±‚ (Execution Layer)

```
äº¤æ˜“å¤„ç†å’ŒçŠ¶æ€ç®¡ç†
â”œâ”€â”€ EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰
â”œâ”€â”€ äº¤æ˜“æ± ï¼ˆMempoolï¼‰
â”œâ”€â”€ Gasè®¡é‡
â””â”€â”€ çŠ¶æ€è½¬æ¢
```

#### å…±è¯†å±‚ (Consensus Layer)

```
åŒºå—éªŒè¯å’Œæœ€ç»ˆç¡®å®š
â”œâ”€â”€ ä¿¡æ ‡é“¾ï¼ˆBeacon Chainï¼‰
â”œâ”€â”€ PoSéªŒè¯è€…
â”œâ”€â”€ Slot/Epochæœºåˆ¶
â””â”€â”€ æœ€ç»ˆç¡®å®šæ€§
```

#### ç½‘ç»œå±‚ (Networking Layer)

```
èŠ‚ç‚¹é€šä¿¡
â”œâ”€â”€ P2Påè®®ï¼ˆdevp2p/libp2pï¼‰
â”œâ”€â”€ èŠ‚ç‚¹å‘ç°
â”œâ”€â”€ åŒºå—ä¼ æ’­
â””â”€â”€ äº¤æ˜“å¹¿æ’­
```

#### å­˜å‚¨å±‚ (Storage Layer)

```
æŒä¹…åŒ–æ•°æ®
â”œâ”€â”€ åŒºå—é“¾æ•°æ®
â”œâ”€â”€ çŠ¶æ€æ ‘
â”œâ”€â”€ äº¤æ˜“å†å²
â””â”€â”€ æ”¶æ®æ—¥å¿—
```

### 2. ä»¥å¤ªåŠ 2.0 æ¶æ„å˜åŒ–

#### The Merge å‰åå¯¹æ¯”

```mermaid
graph LR
    subgraph "åˆå¹¶å‰ (Pre-Merge)"
        A1[æ‰§è¡Œå±‚<br/>PoWæŒ–çŸ¿] --> A2[å•å±‚æ¶æ„]
    end

    subgraph "åˆå¹¶å (Post-Merge)"
        B1[æ‰§è¡Œå±‚<br/>äº¤æ˜“å¤„ç†] -.åŒå‘é€šä¿¡.-> B2[å…±è¯†å±‚<br/>PoSéªŒè¯]
    end

    A2 -->|The Merge<br/>2022.09.15| B1

    style A1 fill:#ffcdd2
    style A2 fill:#ef9a9a
    style B1 fill:#c8e6c9
    style B2 fill:#81c784
```

**å…³é”®æ”¹å˜ï¼š**

| æ–¹é¢       | Merge å‰          | Merge å                   |
| ---------- | ----------------- | -------------------------- |
| å…±è¯†æœºåˆ¶   | PoWï¼ˆå·¥ä½œé‡è¯æ˜ï¼‰ | PoSï¼ˆæƒç›Šè¯æ˜ï¼‰            |
| èƒ½æºæ¶ˆè€—   | é«˜ï¼ˆ~100 TWh/å¹´ï¼‰ | ä½ï¼ˆ~0.01 TWh/å¹´ï¼‰â¬‡ï¸99.95% |
| åŒºå—æ—¶é—´   | ~13.5 ç§’ï¼ˆå¯å˜ï¼‰  | ~12 ç§’ï¼ˆå›ºå®šï¼‰             |
| éªŒè¯æ–¹å¼   | ç®—åŠ›ç«äº‰          | è´¨æŠ¼ ETH æŠ•ç¥¨              |
| ç¯å¢ƒå½±å“   | å¤§                | æå°                       |
| æœ€ç»ˆç¡®å®šæ€§ | ~6-30 åˆ†é’Ÿ        | ~13 åˆ†é’Ÿï¼ˆ2 ä¸ª Epochï¼‰     |

#### åŒå±‚æ¶æ„è¯¦è§£

```mermaid
graph TB
    subgraph "æ‰§è¡Œå±‚ (Execution Layer)"
        E1[äº¤æ˜“æ¥æ”¶]
        E2[EVMæ‰§è¡Œ]
        E3[çŠ¶æ€æ›´æ–°]
        E4[Gasè®¡ç®—]

        E1 --> E2 --> E3 --> E4
    end

    subgraph "å…±è¯†å±‚ (Consensus Layer)"
        C1[éªŒè¯è€…ç®¡ç†]
        C2[åŒºå—æè®®]
        C3[å§”å‘˜ä¼šæŠ•ç¥¨]
        C4[æœ€ç»ˆç¡®å®š]

        C1 --> C2 --> C3 --> C4
    end

    E4 -.Engine API.-> C2
    C4 -.åŒºå—ç¡®è®¤.-> E1

    style E1 fill:#fff3e0
    style E2 fill:#ffe0b2
    style E3 fill:#ffcc80
    style E4 fill:#ffb74d
    style C1 fill:#e3f2fd
    style C2 fill:#bbdefb
    style C3 fill:#90caf9
    style C4 fill:#64b5f6
```

**Engine APIï¼ˆå¼•æ“ APIï¼‰ï¼š**

- è¿æ¥æ‰§è¡Œå±‚å’Œå…±è¯†å±‚
- ä¼ é€’åŒºå—æè®®
- åŒæ­¥æ‰§è¡Œç»“æœ
- åè°ƒæœ€ç»ˆç¡®å®šæ€§

---

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. è´¦æˆ·ç³»ç»Ÿ

ä»¥å¤ªåŠæœ‰ä¸¤ç§è´¦æˆ·ç±»å‹ï¼Œå®ƒä»¬æ„æˆäº†æ•´ä¸ªç½‘ç»œçš„åŸºç¡€ï¼š

#### è´¦æˆ·ç±»å‹å¯¹æ¯”

```mermaid
graph TB
    subgraph "å¤–éƒ¨è´¦æˆ· (EOA)"
        EOA1[åœ°å€<br/>0x742d...]
        EOA2[ä½™é¢<br/>10.5 ETH]
        EOA3[Nonce<br/>42]
        EOA4[ç§é’¥æ§åˆ¶<br/>å¯å‘èµ·äº¤æ˜“]

        EOA1 --- EOA2 --- EOA3 --- EOA4
    end

    subgraph "åˆçº¦è´¦æˆ· (Contract)"
        CA1[åœ°å€<br/>0x1f98...]
        CA2[ä½™é¢<br/>1000 ETH]
        CA3[Nonce<br/>1]
        CA4[å­—èŠ‚ç <br/>æ™ºèƒ½åˆçº¦ä»£ç ]
        CA5[å­˜å‚¨<br/>çŠ¶æ€æ•°æ®]

        CA1 --- CA2 --- CA3 --- CA4 --- CA5
    end

    style EOA1 fill:#e8f5e9
    style EOA2 fill:#c8e6c9
    style EOA3 fill:#a5d6a7
    style EOA4 fill:#81c784
    style CA1 fill:#e1f5fe
    style CA2 fill:#b3e5fc
    style CA3 fill:#81d4fa
    style CA4 fill:#4fc3f7
    style CA5 fill:#29b6f6
```

#### å¤–éƒ¨è´¦æˆ· (EOA - Externally Owned Account)

```
ç»„æˆéƒ¨åˆ†ï¼š
â”œâ”€â”€ Address: 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb
â”‚   â””â”€â”€ ç”±å…¬é’¥é€šè¿‡Keccak-256å“ˆå¸Œç”Ÿæˆ
â”œâ”€â”€ Balance: 10.5 ETH
â”‚   â””â”€â”€ å½“å‰æŒæœ‰çš„ä»¥å¤ªå¸æ•°é‡
â”œâ”€â”€ Nonce: 42
â”‚   â””â”€â”€ å·²å‘é€çš„äº¤æ˜“è®¡æ•°ï¼ˆä»0å¼€å§‹ï¼‰
â””â”€â”€ ç”±ç§é’¥æ§åˆ¶
    â””â”€â”€ æŒæœ‰ç§é’¥ = å®Œå…¨æ§åˆ¶è´¦æˆ·

ç‰¹ç‚¹ï¼š
âœ… å¯ä»¥ä¸»åŠ¨å‘èµ·äº¤æ˜“
âœ… å¯ä»¥æŒæœ‰ETHå’Œä»£å¸
âœ… æ²¡æœ‰å¯æ‰§è¡Œä»£ç 
âœ… ç”±äººç±»æˆ–ç¨‹åºæ§åˆ¶ï¼ˆé€šè¿‡ç§é’¥ï¼‰
âœ… åˆ›å»ºè´¦æˆ·å…è´¹ï¼ˆåªéœ€ç”Ÿæˆå¯†é’¥å¯¹ï¼‰
```

#### åˆçº¦è´¦æˆ· (Contract Account)

```
ç»„æˆéƒ¨åˆ†ï¼š
â”œâ”€â”€ Address: 0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984
â”‚   â””â”€â”€ ç”±åˆ›å»ºè€…åœ°å€å’Œnonceè®¡ç®—å¾—å‡º
â”œâ”€â”€ Balance: 1000 ETH
â”‚   â””â”€â”€ åˆçº¦æŒæœ‰çš„ä»¥å¤ªå¸
â”œâ”€â”€ Nonce: 1
â”‚   â””â”€â”€ ç”±è¯¥åˆçº¦åˆ›å»ºçš„åˆçº¦æ•°é‡
â”œâ”€â”€ Code: æ™ºèƒ½åˆçº¦å­—èŠ‚ç 
â”‚   â””â”€â”€ ä¸å¯æ›´æ”¹çš„ç¨‹åºé€»è¾‘
â””â”€â”€ Storage: æŒä¹…åŒ–å­˜å‚¨ç©ºé—´
    â””â”€â”€ åˆçº¦çš„çŠ¶æ€å˜é‡

ç‰¹ç‚¹ï¼š
âœ… ä¸èƒ½ä¸»åŠ¨å‘èµ·äº¤æ˜“ï¼ˆè¢«åŠ¨è§¦å‘ï¼‰
âœ… å¯ä»¥æŒæœ‰ETHå’Œä»£å¸
âœ… åŒ…å«å¯æ‰§è¡Œä»£ç 
âœ… ç”±ä»£ç é€»è¾‘æ§åˆ¶
âœ… åˆ›å»ºéœ€è¦Gasè´¹ç”¨
âœ… éƒ¨ç½²åä»£ç ä¸å¯æ›´æ”¹ï¼ˆé™¤éä½¿ç”¨ä»£ç†æ¨¡å¼ï¼‰
```

#### è´¦æˆ·äº¤äº’æµç¨‹

```mermaid
sequenceDiagram
    participant EOA as EOAè´¦æˆ·<br/>(ç”¨æˆ·)
    participant Contract1 as åˆçº¦A<br/>(DEX)
    participant Contract2 as åˆçº¦B<br/>(ä»£å¸)

    EOA->>Contract1: 1. å‘èµ·äº¤æ˜“<br/>swap(100 USDT)
    activate Contract1

    Contract1->>Contract2: 2. è°ƒç”¨<br/>transferFrom()
    activate Contract2

    Contract2->>Contract2: 3. æ£€æŸ¥æˆæƒ
    Contract2->>EOA: 4. æ‰£é™¤ä»£å¸
    Contract2-->>Contract1: 5. è¿”å›æˆåŠŸ
    deactivate Contract2

    Contract1->>Contract1: 6. è®¡ç®—å…‘æ¢ç‡
    Contract1->>EOA: 7. å‘é€ETH
    Contract1-->>EOA: 8. è¿”å›ç»“æœ
    deactivate Contract1
```

### 2. äº¤æ˜“ç»“æ„

#### å®Œæ•´çš„äº¤æ˜“å¯¹è±¡

```javascript
{
  // ===== åŸºæœ¬ä¿¡æ¯ =====
  from: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
  // äº¤æ˜“å‘èµ·è€…åœ°å€ï¼ˆEOAï¼‰

  to: "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
  // æ¥æ”¶è€…åœ°å€ï¼ˆEOAæˆ–åˆçº¦ï¼‰ï¼Œnullåˆ™ä¸ºåˆ›å»ºåˆçº¦

  value: "1000000000000000000", // 1 ETH in Wei
  // è½¬è´¦é‡‘é¢ï¼ˆ1 ETH = 10^18 Weiï¼‰

  nonce: 42,
  // å‘é€è€…çš„äº¤æ˜“åºå·ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰

  // ===== Gasç›¸å…³ (EIP-1559) =====
  gasLimit: 21000,
  // æ„¿æ„æ”¯ä»˜çš„æœ€å¤§gasæ•°é‡

  maxFeePerGas: "100000000000", // 100 Gwei
  // æ„¿æ„æ”¯ä»˜çš„æœ€é«˜gasä»·æ ¼ï¼ˆåŸºç¡€è´¹ç”¨+å°è´¹ï¼‰

  maxPriorityFeePerGas: "2000000000", // 2 Gwei
  // ç»™éªŒè¯è€…çš„å°è´¹ï¼ˆä¼˜å…ˆè´¹ï¼‰

  // ===== æ•°æ® =====
  data: "0xa9059cbb000000000000000...",
  // è¾“å…¥æ•°æ®ï¼ˆåˆçº¦è°ƒç”¨çš„ç¼–ç æ•°æ®ï¼‰
  // ç®€å•è½¬è´¦æ—¶ä¸º "0x"ï¼ˆç©ºï¼‰

  // ===== ç­¾å (ECDSA) =====
  v: 28,
  // æ¢å¤æ ‡è¯†ç¬¦ï¼ˆ27æˆ–28ï¼Œç”¨äºæ¢å¤å…¬é’¥ï¼‰

  r: "0x88ff6cf0fefd94db46111149ae4bfc179e9b94721fffd821d38d16464b3f71d0",
  // ç­¾åçš„rå€¼

  s: "0x45e0aff800961cfce805daef7016b9b675c137a6a41a548f7b60a3484c06a33a",
  // ç­¾åçš„så€¼

  // ===== å…ƒæ•°æ® =====
  type: 2,
  // äº¤æ˜“ç±»å‹ï¼ˆ0=ä¼ ç»Ÿ, 1=è®¿é—®åˆ—è¡¨, 2=EIP-1559ï¼‰

  chainId: 1,
  // é“¾IDï¼ˆ1=ä¸»ç½‘, 5=Goerli, 11155111=Sepoliaï¼‰
}
```

#### äº¤æ˜“ç±»å‹æ¼”åŒ–

```mermaid
timeline
    title ä»¥å¤ªåŠäº¤æ˜“ç±»å‹æ¼”åŒ–

    2015 : Type 0<br/>ä¼ ç»Ÿäº¤æ˜“
         : å›ºå®šgasPrice
         : æœ€åŸºç¡€çš„äº¤æ˜“æ ¼å¼

    2021-04 : Type 1 (EIP-2930)<br/>è®¿é—®åˆ—è¡¨äº¤æ˜“
            : é¢„å£°æ˜è®¿é—®çš„åœ°å€
            : è½»å¾®gasä¼˜åŒ–

    2021-08 : Type 2 (EIP-1559)<br/>åŠ¨æ€è´¹ç”¨äº¤æ˜“
            : maxFeePerGas
            : maxPriorityFeePerGas
            : æ›´å¯é¢„æµ‹çš„è´¹ç”¨
```

**Type 0: ä¼ ç»Ÿäº¤æ˜“ï¼ˆLegacyï¼‰**

```javascript
{
  gasPrice: "50000000000", // å›ºå®šä»·æ ¼
  // é—®é¢˜ï¼šè´¹ç”¨ä¸å¯é¢„æµ‹ï¼Œå®¹æ˜“è¿‡é«˜æˆ–è¿‡ä½
}
```

**Type 1: è®¿é—®åˆ—è¡¨äº¤æ˜“ï¼ˆEIP-2930ï¼‰**

```javascript
{
  gasPrice: "50000000000",
  accessList: [
    {
      address: "0x...",
      storageKeys: ["0x0000...", "0x0001..."]
    }
  ]
  // é¢„å…ˆå£°æ˜è¦è®¿é—®çš„åœ°å€å’Œå­˜å‚¨æ§½
  // å¯ä»¥èŠ‚çœä¸€äº›gasï¼ˆå†·è®¿é—® â†’ çƒ­è®¿é—®ï¼‰
}
```

**Type 2: åŠ¨æ€è´¹ç”¨äº¤æ˜“ï¼ˆEIP-1559ï¼‰**

```javascript
{
  maxFeePerGas: "100000000000",          // æœ€é«˜æ„¿æ„æ”¯ä»˜
  maxPriorityFeePerGas: "2000000000",    // ç»™éªŒè¯è€…çš„å°è´¹
  // å®é™…æ”¯ä»˜ = min(baseFee + priorityFee, maxFee)
  // å¤šä½™çš„ä¼šé€€è¿˜
}
```

#### äº¤æ˜“ç”Ÿå‘½å‘¨æœŸ

```mermaid
stateDiagram-v2
    [*] --> åˆ›å»ºäº¤æ˜“: ç”¨æˆ·ç­¾å
    åˆ›å»ºäº¤æ˜“ --> å¹¿æ’­åˆ°ç½‘ç»œ: å‘é€åˆ°èŠ‚ç‚¹

    å¹¿æ’­åˆ°ç½‘ç»œ --> äº¤æ˜“æ± : éªŒè¯é€šè¿‡
    å¹¿æ’­åˆ°ç½‘ç»œ --> æ‹’ç»: éªŒè¯å¤±è´¥

    äº¤æ˜“æ±  --> æ‰“åŒ…ä¸­: éªŒè¯è€…é€‰æ‹©
    äº¤æ˜“æ±  --> ç­‰å¾…ä¸­: Gasä»·æ ¼ä½

    æ‰“åŒ…ä¸­ --> åŒºå—ä¸­: åŒ…å«åœ¨æ–°åŒºå—
    åŒºå—ä¸­ --> ç¡®è®¤1: åŒºå—è¢«æ¥å—
    ç¡®è®¤1 --> ç¡®è®¤N: ç»§ç»­ç¡®è®¤
    ç¡®è®¤N --> æœ€ç»ˆç¡®å®š: 32ä¸ªslotå

    æœ€ç»ˆç¡®å®š --> [*]: ä¸å¯é€†
    æ‹’ç» --> [*]: äº¤æ˜“å¤±è´¥

    ç­‰å¾…ä¸­ --> è¿‡æœŸ: é•¿æ—¶é—´æœªæ‰“åŒ…
    è¿‡æœŸ --> [*]
```

### 3. åŒºå—ç»“æ„

#### åŒºå—çš„å®Œæ•´ç»“æ„

```mermaid
graph TB
    subgraph "åŒºå— (Block)"
        Header[åŒºå—å¤´ Header]
        Body[åŒºå—ä½“ Body]

        Header --> Body
    end

    subgraph "åŒºå—å¤´å†…å®¹"
        H1[parentHash<br/>çˆ¶åŒºå—å“ˆå¸Œ]
        H2[stateRoot<br/>çŠ¶æ€æ ‘æ ¹]
        H3[transactionsRoot<br/>äº¤æ˜“æ ‘æ ¹]
        H4[receiptsRoot<br/>æ”¶æ®æ ‘æ ¹]
        H5[number<br/>åŒºå—å·]
        H6[timestamp<br/>æ—¶é—´æˆ³]
        H7[gasUsed<br/>Gasä½¿ç”¨é‡]
        H8[baseFeePerGas<br/>åŸºç¡€è´¹ç”¨]
    end

    subgraph "åŒºå—ä½“å†…å®¹"
        B1[transactions<br/>äº¤æ˜“åˆ—è¡¨]
        B2[withdrawals<br/>ææ¬¾åˆ—è¡¨ PoS]
    end

    Header -.-> H1
    Header -.-> H2
    Header -.-> H3
    Header -.-> H4
    Header -.-> H5
    Header -.-> H6
    Header -.-> H7
    Header -.-> H8

    Body -.-> B1
    Body -.-> B2

    style Header fill:#e1f5fe
    style Body fill:#fff3e0
```

**åŒºå—å¤´ (Block Header) è¯¦è§£ï¼š**

```javascript
{
  // ===== é“¾æ¥ =====
  parentHash: "0x1234...",
  // çˆ¶åŒºå—çš„å“ˆå¸Œï¼ˆå½¢æˆé“¾ï¼‰

  // ===== çŠ¶æ€æ ¹ =====
  stateRoot: "0xabcd...",
  // æ‰§è¡Œæ‰€æœ‰äº¤æ˜“åçš„ä¸–ç•ŒçŠ¶æ€æ ¹å“ˆå¸Œ

  transactionsRoot: "0xef01...",
  // åŒºå—å†…æ‰€æœ‰äº¤æ˜“çš„Merkleæ ‘æ ¹

  receiptsRoot: "0x2345...",
  // æ‰€æœ‰äº¤æ˜“æ”¶æ®çš„Merkleæ ‘æ ¹

  // ===== æ—¥å¿— =====
  logsBloom: "0x0000...",
  // å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆå¿«é€ŸæŸ¥æ‰¾æ—¥å¿—ï¼‰

  // ===== åŒºå—ä¿¡æ¯ =====
  number: 18000000,
  // åŒºå—å·ï¼ˆä»0å¼€å§‹é€’å¢ï¼‰

  timestamp: 1699999999,
  // Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰

  // ===== Gas =====
  gasLimit: 30000000,
  // åŒºå—çš„Gasä¸Šé™

  gasUsed: 15234567,
  // å®é™…ä½¿ç”¨çš„Gas

  baseFeePerGas: "30000000000", // 30 Gwei
  // EIP-1559åŸºç¡€è´¹ç”¨

  // ===== PoSç›¸å…³ =====
  difficulty: 0,
  // PoSåå›ºå®šä¸º0ï¼ˆPoWæ—¶ä»£çš„éš¾åº¦ï¼‰

  extraData: "0x...",
  // é¢å¤–æ•°æ®ï¼ˆéªŒè¯è€…å¯æ·»åŠ ä¿¡æ¯ï¼Œæœ€å¤š32å­—èŠ‚ï¼‰

  // ===== å·²å¼ƒç”¨ (PoWæ—¶ä»£) =====
  mixHash: "0x0000...",
  // PoWæ··åˆå“ˆå¸Œï¼ˆPoSåæ— æ„ä¹‰ï¼‰

  nonce: "0x0000000000000000",
  // PoWéšæœºæ•°ï¼ˆPoSåå›ºå®šä¸º0ï¼‰
}
```

**åŒºå—ä½“ (Block Body)ï¼š**

```javascript
{
  // äº¤æ˜“åˆ—è¡¨
  transactions: [
    {
      from: "0x742d...",
      to: "0x1f98...",
      value: "1000000000000000000",
      // ... å®Œæ•´äº¤æ˜“å¯¹è±¡
    },
    // ... æ›´å¤šäº¤æ˜“
  ],

  // PoSææ¬¾ï¼ˆThe Mergeåæ–°å¢ï¼‰
  withdrawals: [
    {
      index: 12345,
      validatorIndex: 67890,
      address: "0x742d...",
      amount: "32000000000" // 32 ETH in Gwei
    },
    // ... æ›´å¤šææ¬¾
  ]
}
```

#### åŒºå—é“¾ç»“æ„

```mermaid
graph LR
    B0[åˆ›ä¸–åŒºå—<br/>Block 0] --> B1[åŒºå— 1<br/>Parent: Block 0]
    B1 --> B2[åŒºå— 2<br/>Parent: Block 1]
    B2 --> B3[åŒºå— 3<br/>Parent: Block 2]
    B3 --> B4[åŒºå— 4<br/>Parent: Block 3]
    B4 --> B5[...]

    style B0 fill:#81c784
    style B1 fill:#aed581
    style B2 fill:#c5e1a5
    style B3 fill:#dce775
    style B4 fill:#e6ee9c
```

### 4. ä¸–ç•ŒçŠ¶æ€ (World State)

#### çŠ¶æ€æœºæ¦‚å¿µ

```mermaid
graph LR
    S0[çŠ¶æ€ S0] -->|äº¤æ˜“ T1| S1[çŠ¶æ€ S1]
    S1 -->|äº¤æ˜“ T2| S2[çŠ¶æ€ S2]
    S2 -->|äº¤æ˜“ T3| S3[çŠ¶æ€ S3]
    S3 -->|äº¤æ˜“ T4| S4[...]

    style S0 fill:#e3f2fd
    style S1 fill:#bbdefb
    style S2 fill:#90caf9
    style S3 fill:#64b5f6
```

**ç¤ºä¾‹ï¼šçŠ¶æ€è½¬æ¢**

```
åˆå§‹çŠ¶æ€ S0:
â”œâ”€â”€ Alice: 10 ETH
â””â”€â”€ Bob: 5 ETH

äº¤æ˜“ T1: Alice â†’ Bob (5 ETH)
    â†“

æ–°çŠ¶æ€ S1:
â”œâ”€â”€ Alice: 5 ETH
â””â”€â”€ Bob: 10 ETH

äº¤æ˜“ T2: Bob â†’ Charlie (3 ETH)
    â†“

æ–°çŠ¶æ€ S2:
â”œâ”€â”€ Alice: 5 ETH
â”œâ”€â”€ Bob: 7 ETH
â””â”€â”€ Charlie: 3 ETH
```

#### è´¦æˆ·çŠ¶æ€ç»“æ„

```javascript
// æ¯ä¸ªè´¦æˆ·çš„çŠ¶æ€
AccountState = {
  nonce: 42,
  // äº¤æ˜“è®¡æ•°æˆ–åˆ›å»ºçš„åˆçº¦æ•°

  balance: '10500000000000000000', // 10.5 ETH
  // è´¦æˆ·ä½™é¢ï¼ˆä»¥Weiä¸ºå•ä½ï¼‰

  storageRoot: '0x56e8...',
  // è¯¥è´¦æˆ·çš„å­˜å‚¨æ ‘æ ¹å“ˆå¸Œ
  // EOAè´¦æˆ·è¿™ä¸ªå­—æ®µä¸ºç©ºæ ‘æ ¹

  codeHash: '0xc5d2...',
  // åˆçº¦ä»£ç çš„å“ˆå¸Œ
  // EOAè´¦æˆ·è¿™ä¸ªå­—æ®µä¸ºç©ºå­—ç¬¦ä¸²çš„å“ˆå¸Œ
};
```

---

## èŠ‚ç‚¹ç±»å‹ä¸ç½‘ç»œå±‚

### 1. èŠ‚ç‚¹ç±»å‹å¯¹æ¯”

```mermaid
graph TB
    subgraph "å…¨èŠ‚ç‚¹ Full Node"
        F1[å­˜å‚¨å®Œæ•´åŒºå—é“¾]
        F2[éªŒè¯æ‰€æœ‰äº¤æ˜“]
        F3[å¯ç‹¬ç«‹éªŒè¯çŠ¶æ€]
        F4[å­˜å‚¨éœ€æ±‚: 1TB+]
    end

    subgraph "è½»èŠ‚ç‚¹ Light Node"
        L1[åªå­˜å‚¨åŒºå—å¤´]
        L2[æŒ‰éœ€è¯·æ±‚æ•°æ®]
        L3[ä¾èµ–å…¨èŠ‚ç‚¹éªŒè¯]
        L4[å­˜å‚¨éœ€æ±‚: 1GB]
    end

    subgraph "å½’æ¡£èŠ‚ç‚¹ Archive Node"
        A1[å­˜å‚¨æ‰€æœ‰å†å²çŠ¶æ€]
        A2[å¯æŸ¥è¯¢ä»»æ„æ—¶åˆ»]
        A3[ä¸ä¿®å‰ªæ—§æ•°æ®]
        A4[å­˜å‚¨éœ€æ±‚: 12TB+]
    end

    subgraph "éªŒè¯è€…èŠ‚ç‚¹ Validator"
        V1[è´¨æŠ¼32 ETH]
        V2[å‚ä¸å…±è¯†]
        V3[æè®®å’ŒéªŒè¯åŒºå—]
        V4[è·å¾—å¥–åŠ±]
    end

    style F1 fill:#c8e6c9
    style L1 fill:#fff9c4
    style A1 fill:#ffccbc
    style V1 fill:#bbdefb
```

#### è¯¦ç»†å¯¹æ¯”è¡¨

| ç‰¹æ€§         | å…¨èŠ‚ç‚¹      | è½»èŠ‚ç‚¹   | å½’æ¡£èŠ‚ç‚¹   | éªŒè¯è€…èŠ‚ç‚¹  |
| ------------ | ----------- | -------- | ---------- | ----------- |
| **å­˜å‚¨éœ€æ±‚** | ~1TB        | ~1GB     | ~12TB      | ~2TB        |
| **å†…å­˜éœ€æ±‚** | 16GB        | 4GB      | 64GB+      | 32GB        |
| **åŒæ­¥æ—¶é—´** | æ•°å°æ—¶      | å‡ åˆ†é’Ÿ   | æ•°å¤©       | æ•°å°æ—¶      |
| **éªŒè¯èƒ½åŠ›** | å®Œå…¨éªŒè¯    | ä¾èµ–ä»–äºº | å®Œå…¨éªŒè¯   | å®Œå…¨éªŒè¯    |
| **å†å²æŸ¥è¯¢** | æœ€è¿‘ 128 å— | ä¸æ”¯æŒ   | æ‰€æœ‰å†å²   | æœ€è¿‘ 128 å— |
| **ç½‘ç»œè´¡çŒ®** | é«˜          | ä½       | é«˜         | æœ€é«˜        |
| **é€‚ç”¨åœºæ™¯** | DApp åç«¯   | ç§»åŠ¨é’±åŒ… | åŒºå—æµè§ˆå™¨ | è´¨æŠ¼æ”¶ç›Š    |
| **è¿è¥æˆæœ¬** | ä¸­          | ä½       | é«˜         | ä¸­-é«˜       |

### 2. å®¢æˆ·ç«¯å®ç°

#### æ‰§è¡Œå±‚å®¢æˆ·ç«¯ç”Ÿæ€

```mermaid
pie title æ‰§è¡Œå±‚å®¢æˆ·ç«¯å¸‚åœºä»½é¢
    "Geth (Go)" : 70
    "Erigon (Go)" : 10
    "Nethermind (C#)" : 10
    "Besu (Java)" : 5
    "Others" : 5
```

**ä¸»æµæ‰§è¡Œå±‚å®¢æˆ·ç«¯ï¼š**

| å®¢æˆ·ç«¯         | è¯­è¨€ | ä¼˜åŠ¿                   | åŠ£åŠ¿               |
| -------------- | ---- | ---------------------- | ------------------ |
| **Geth**       | Go   | æœ€æˆç†Ÿã€æœ€æµè¡Œã€æ–‡æ¡£å…¨ | åŒæ­¥æ…¢ã€èµ„æºå ç”¨é«˜ |
| **Erigon**     | Go   | å¿«é€ŸåŒæ­¥ã€ä½å­˜å‚¨       | è¾ƒæ–°ã€å¯èƒ½æœ‰ bug   |
| **Nethermind** | C#   | .NET ç”Ÿæ€ã€ä¼ä¸šæ”¯æŒ    | ç¤¾åŒºè¾ƒå°           |
| **Besu**       | Java | ä¼ä¸šçº§ã€éšç§åŠŸèƒ½       | èµ„æºå ç”¨é«˜         |

#### å…±è¯†å±‚å®¢æˆ·ç«¯ç”Ÿæ€

```mermaid
pie title å…±è¯†å±‚å®¢æˆ·ç«¯å¸‚åœºä»½é¢
    "Prysm (Go)" : 40
    "Lighthouse (Rust)" : 30
    "Teku (Java)" : 15
    "Nimbus (Nim)" : 10
    "Others" : 5
```

**ä¸»æµå…±è¯†å±‚å®¢æˆ·ç«¯ï¼š**

| å®¢æˆ·ç«¯         | è¯­è¨€ | ä¼˜åŠ¿             | åŠ£åŠ¿                 |
| -------------- | ---- | ---------------- | -------------------- |
| **Prysm**      | Go   | åŠŸèƒ½ä¸°å¯Œã€æ›´æ–°å¿« | å¸‚åœºå æ¯”è¿‡é«˜ï¼ˆé£é™©ï¼‰ |
| **Lighthouse** | Rust | æ€§èƒ½ä¼˜ç§€ã€å®‰å…¨   | é…ç½®è¾ƒå¤æ‚           |
| **Teku**       | Java | ä¼ä¸šæ”¯æŒã€æ˜“ç”¨   | èµ„æºå ç”¨é«˜           |
| **Nimbus**     | Nim  | è½»é‡çº§ã€ä½èµ„æº   | åŠŸèƒ½ç›¸å¯¹ç®€å•         |

#### å®¢æˆ·ç«¯å¤šæ ·æ€§çš„é‡è¦æ€§

```mermaid
graph TB
    A[å•ä¸€å®¢æˆ·ç«¯ä¸»å¯¼] --> B[å®¢æˆ·ç«¯å‘ç°Bug]
    B --> C[å¤§é‡èŠ‚ç‚¹å—å½±å“]
    C --> D[ç½‘ç»œåˆ†å‰é£é™©]
    D --> E[ä¸¥é‡å®‰å…¨é—®é¢˜]

    F[å¤šå®¢æˆ·ç«¯ç”Ÿæ€] --> G[æŸå®¢æˆ·ç«¯Bug]
    G --> H[ä»…éƒ¨åˆ†èŠ‚ç‚¹å—å½±å“]
    H --> I[å…¶ä»–å®¢æˆ·ç«¯æ­£å¸¸]
    I --> J[ç½‘ç»œç»§ç»­è¿è¡Œ]

    style A fill:#ffcdd2
    style E fill:#f44336
    style F fill:#c8e6c9
    style J fill:#4caf50
```

**å†å²æ•™è®­ï¼š**

- 2016 å¹´ï¼šGeth å’Œ Parity å¯¹åŒºå—å·çš„å¤„ç†å·®å¼‚å¯¼è‡´åˆ†å‰
- å¤šå®¢æˆ·ç«¯å¯ä»¥é˜²æ­¢å•ç‚¹æ•…éšœ
- ç›®æ ‡ï¼šæ— å•ä¸€å®¢æˆ·ç«¯è¶…è¿‡ 33%ä»½é¢

### 3. ç½‘ç»œå±‚æ¶æ„

#### P2P ç½‘ç»œæ‹“æ‰‘

```mermaid
graph TB
    N1((èŠ‚ç‚¹1))
    N2((èŠ‚ç‚¹2))
    N3((èŠ‚ç‚¹3))
    N4((èŠ‚ç‚¹4))
    N5((èŠ‚ç‚¹5))
    N6((èŠ‚ç‚¹6))
    N7((èŠ‚ç‚¹7))
    N8((èŠ‚ç‚¹8))

    N1 --- N2
    N1 --- N3
    N1 --- N4
    N2 --- N5
    N2 --- N6
    N3 --- N7
    N4 --- N8
    N5 --- N6
    N6 --- N7
    N7 --- N8

    style N1 fill:#81c784
    style N2 fill:#aed581
    style N3 fill:#c5e1a5
    style N4 fill:#dce775
    style N5 fill:#e6ee9c
    style N6 fill:#f0f4c3
    style N7 fill:#fff9c4
    style N8 fill:#ffecb3
```

**ç‰¹ç‚¹ï¼š**

- æ¯ä¸ªèŠ‚ç‚¹è¿æ¥å¤šä¸ªå¯¹ç­‰èŠ‚ç‚¹ï¼ˆé€šå¸¸ 25-50 ä¸ªï¼‰
- æ— ä¸­å¿ƒæœåŠ¡å™¨
- æŠ—å®¡æŸ¥
- é«˜å®¹é”™æ€§

#### ç½‘ç»œåè®®æ ˆ

```mermaid
graph TB
    subgraph "æ‰§è¡Œå±‚ç½‘ç»œ"
        E1[devp2p<br/>èŠ‚ç‚¹å‘ç°åè®®]
        E2[RLPx<br/>åŠ å¯†ä¼ è¾“]
        E3[eth/68<br/>ä»¥å¤ªåŠå­åè®®]

        E1 --> E2 --> E3
    end

    subgraph "å…±è¯†å±‚ç½‘ç»œ"
        C1[libp2p<br/>ç°ä»£P2Pæ¡†æ¶]
        C2[gossipsub<br/>æ¶ˆæ¯ä¼ æ’­]
        C3[reqresp<br/>è¯·æ±‚å“åº”]

        C1 --> C2
        C1 --> C3
    end

    style E1 fill:#fff3e0
    style E2 fill:#ffe0b2
    style E3 fill:#ffcc80
    style C1 fill:#e1f5fe
    style C2 fill:#b3e5fc
    style C3 fill:#81d4fa
```

#### äº¤æ˜“ä¼ æ’­æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·é’±åŒ…
    participant N1 as èŠ‚ç‚¹A
    participant N2 as èŠ‚ç‚¹B
    participant N3 as èŠ‚ç‚¹C
    participant N4 as èŠ‚ç‚¹D
    participant V as éªŒè¯è€…

    U->>N1: 1. æäº¤äº¤æ˜“
    activate N1
    N1->>N1: 2. éªŒè¯ç­¾å
    N1->>N2: 3. å¹¿æ’­äº¤æ˜“
    N1->>N3: 3. å¹¿æ’­äº¤æ˜“
    deactivate N1

    activate N2
    activate N3
    N2->>N4: 4. ç»§ç»­ä¼ æ’­
    N3->>V: 4. ç»§ç»­ä¼ æ’­
    deactivate N2
    deactivate N3

    activate V
    V->>V: 5. æ”¶é›†äº¤æ˜“<br/>ç­‰å¾…æ‰“åŒ…
    deactivate V

    Note over U,V: å…¨ç½‘ä¼ æ’­æ—¶é—´: ~1-2ç§’
```

**ä¼ æ’­è¿‡ç¨‹è¯¦è§£ï¼š**

1. **äº¤æ˜“éªŒè¯**ï¼ˆæ¯ä¸ªèŠ‚ç‚¹ï¼‰

   - æ£€æŸ¥ç­¾åæœ‰æ•ˆæ€§
   - éªŒè¯ nonce æ­£ç¡®æ€§
   - ç¡®è®¤ä½™é¢å……è¶³
   - æ£€æŸ¥ gas limit åˆç†

2. **å¹¿æ’­ç­–ç•¥**

   - ä½¿ç”¨ gossip åè®®
   - æ¯ä¸ªèŠ‚ç‚¹è½¬å‘ç»™éƒ¨åˆ†é‚»å±…
   - ä½¿ç”¨å“ˆå¸Œå»é‡ï¼ˆä¸é‡å¤å‘é€ï¼‰
   - ä¼˜å…ˆä¼ æ’­é«˜ gas price äº¤æ˜“

3. **åŒºå—ä¼ æ’­**
   - æ–°åŒºå—äº§ç”Ÿåç«‹å³å¹¿æ’­
   - ä½¿ç”¨åŒºå—å…¬å‘Šï¼ˆannounceï¼‰
   - å¯¹ç­‰èŠ‚ç‚¹è¯·æ±‚å®Œæ•´åŒºå—
   - å…¨ç½‘ä¼ æ’­æ—¶é—´ï¼š~0.5-1 ç§’

---

## çŠ¶æ€ä¸å­˜å‚¨æœºåˆ¶

### 1. å­˜å‚¨å±‚æ¬¡ç»“æ„

```mermaid
graph TB
    subgraph "é“¾ä¸Šæ°¸ä¹…å­˜å‚¨"
        S1[åŒºå—é“¾æ•°æ®]
        S2[ä¸–ç•ŒçŠ¶æ€]
        S3[äº¤æ˜“å†å²]
        S4[åˆçº¦ä»£ç ]

        S1 --- S2 --- S3 --- S4
    end

    subgraph "æ‰§è¡ŒæœŸä¸´æ—¶å­˜å‚¨"
        T1[Memory å†…å­˜]
        T2[Stack å †æ ˆ]
        T3[Calldata è°ƒç”¨æ•°æ®]

        T1 --- T2 --- T3
    end

    S2 -.å½±å“.-> T1

    style S1 fill:#e3f2fd
    style S2 fill:#bbdefb
    style S3 fill:#90caf9
    style S4 fill:#64b5f6
    style T1 fill:#fff3e0
    style T2 fill:#ffe0b2
    style T3 fill:#ffcc80
```

### 2. Merkle Patricia Trieï¼ˆMPTï¼‰

#### ä¸ºä»€ä¹ˆä½¿ç”¨ MPTï¼Ÿ

**éœ€æ±‚åˆ†æï¼š**

```
âœ… å¿«é€ŸæŸ¥æ‰¾ â†’ Patricia Trieï¼ˆå‰ç¼€æ ‘ï¼‰
âœ… é«˜æ•ˆéªŒè¯ â†’ Merkle Treeï¼ˆå“ˆå¸Œæ ‘ï¼‰
âœ… èŠ‚çœç©ºé—´ â†’ è·¯å¾„å‹ç¼©
âœ… å¢é‡æ›´æ–° â†’ ä»…ä¿®æ”¹è·¯å¾„

è§£å†³æ–¹æ¡ˆ = Merkle Tree + Patricia Trie
```

#### MPT ç»“æ„å›¾

```mermaid
graph TB
    Root[Root Hash<br/>0xabcd1234]

    Branch1[Branch Node]
    Branch2[Branch Node]

    Leaf1[Leaf<br/>è´¦æˆ·A]
    Leaf2[Leaf<br/>è´¦æˆ·B]
    Leaf3[Leaf<br/>è´¦æˆ·C]
    Leaf4[Leaf<br/>è´¦æˆ·D]

    Root --> Branch1
    Root --> Branch2

    Branch1 --> Leaf1
    Branch1 --> Leaf2

    Branch2 --> Leaf3
    Branch2 --> Leaf4

    style Root fill:#e3f2fd
    style Branch1 fill:#bbdefb
    style Branch2 fill:#bbdefb
    style Leaf1 fill:#81d4fa
    style Leaf2 fill:#81d4fa
    style Leaf3 fill:#81d4fa
    style Leaf4 fill:#81d4fa
```

#### ä¸‰ç§ Trie ç±»å‹

**1. State Trieï¼ˆçŠ¶æ€æ ‘ï¼‰**

```mermaid
graph TB
    StateRoot[State Root<br/>å…¨å±€å”¯ä¸€]

    Account1[åœ°å€: 0x742d...<br/>â†’ è´¦æˆ·çŠ¶æ€]
    Account2[åœ°å€: 0x1f98...<br/>â†’ è´¦æˆ·çŠ¶æ€]
    Account3[åœ°å€: 0x8ba1...<br/>â†’ è´¦æˆ·çŠ¶æ€]

    StateRoot --> Account1
    StateRoot --> Account2
    StateRoot --> Account3

    Detail1[Nonce: 42<br/>Balance: 10 ETH<br/>StorageRoot: 0x...<br/>CodeHash: 0x...]

    Account1 -.-> Detail1

    style StateRoot fill:#4caf50
    style Account1 fill:#81c784
    style Account2 fill:#81c784
    style Account3 fill:#81c784
    style Detail1 fill:#c8e6c9
```

**2. Storage Trieï¼ˆå­˜å‚¨æ ‘ï¼‰**

```mermaid
graph TB
    StorageRoot[Storage Root<br/>æ¯ä¸ªåˆçº¦ä¸€ä¸ª]

    Slot1[å­˜å‚¨æ§½ 0<br/>â†’ owneråœ°å€]
    Slot2[å­˜å‚¨æ§½ 1<br/>â†’ totalSupply]
    Slot3[å­˜å‚¨æ§½ 2<br/>â†’ balancesæ˜ å°„]

    StorageRoot --> Slot1
    StorageRoot --> Slot2
    StorageRoot --> Slot3

    style StorageRoot fill:#2196f3
    style Slot1 fill:#64b5f6
    style Slot2 fill:#64b5f6
    style Slot3 fill:#64b5f6
```

**3. Transactions Trieï¼ˆäº¤æ˜“æ ‘ï¼‰**

```mermaid
graph TB
    TxRoot[Transactions Root<br/>æ¯ä¸ªåŒºå—ä¸€ä¸ª]

    Tx1[äº¤æ˜“ 0]
    Tx2[äº¤æ˜“ 1]
    Tx3[äº¤æ˜“ 2]
    TxN[äº¤æ˜“ n...]

    TxRoot --> Tx1
    TxRoot --> Tx2
    TxRoot --> Tx3
    TxRoot --> TxN

    style TxRoot fill:#ff9800
    style Tx1 fill:#ffb74d
    style Tx2 fill:#ffb74d
    style Tx3 fill:#ffb74d
    style TxN fill:#ffb74d
```

#### MPT çš„ä¼˜åŠ¿

**1. é«˜æ•ˆéªŒè¯ï¼ˆMerkle Proofï¼‰**

```
æŸ¥è¯¢: "è´¦æˆ·0x742d...çš„ä½™é¢æ˜¯å¤šå°‘?"

ä¼ ç»Ÿæ–¹å¼:
éœ€è¦ä¸‹è½½æ•´ä¸ªæ•°æ®åº“ â†’ æ•°TB

ä½¿ç”¨MPT:
åªéœ€è¦ä»æ ¹åˆ°å¶çš„è·¯å¾„ â†’ å‡ KB
```

```mermaid
graph LR
    A[éªŒè¯è€…æœ‰<br/>State Root] --> B[è¯·æ±‚è´¦æˆ·æ•°æ®<br/>+ Merkle Proof]
    B --> C[éªŒè¯è·¯å¾„å“ˆå¸Œ]
    C --> D{åŒ¹é…Root?}
    D -->|æ˜¯| E[æ•°æ®æœ‰æ•ˆâœ“]
    D -->|å¦| F[æ•°æ®æ— æ•ˆâœ—]

    style A fill:#e3f2fd
    style E fill:#c8e6c9
    style F fill:#ffcdd2
```

**2. å¢é‡æ›´æ–°**

```
ä¿®æ”¹ä¸€ä¸ªè´¦æˆ·:
åªéœ€è¦æ›´æ–°ä»æ ¹åˆ°è¯¥è´¦æˆ·çš„è·¯å¾„
å…¶ä»–è·¯å¾„ä¿æŒä¸å˜

ä¾‹å¦‚:
è´¦æˆ·Aä½™é¢å˜åŒ–
â†’ åªæ›´æ–°3-4ä¸ªèŠ‚ç‚¹
â†’ è€Œä¸æ˜¯æ•´æ£µæ ‘
```

### 3. æ•°æ®ä¿®å‰ªï¼ˆPruningï¼‰

#### çŠ¶æ€å¢é•¿é—®é¢˜

```mermaid
graph LR
    A[2015<br/>1GB] --> B[2018<br/>100GB]
    B --> C[2021<br/>400GB]
    C --> D[2024<br/>900GB+]

    style A fill:#c8e6c9
    style B fill:#fff9c4
    style C fill:#ffcc80
    style D fill:#ef9a9a
```

#### ä¿®å‰ªç­–ç•¥

**å…¨èŠ‚ç‚¹ä¿®å‰ªï¼š**

```mermaid
graph TB
    A[ä¿ç•™æœ€è¿‘128ä¸ªåŒºå—çš„çŠ¶æ€]
    B[ä¿®å‰ªæ›´æ—©çš„ä¸­é—´çŠ¶æ€]
    C[ä»å¯éªŒè¯æ–°åŒºå—]
    D[å­˜å‚¨ç©ºé—´: ~500GB]

    A --> B --> C --> D

    style A fill:#c8e6c9
    style D fill:#81c784
```

**å½’æ¡£èŠ‚ç‚¹ï¼ˆä¸ä¿®å‰ªï¼‰ï¼š**

```mermaid
graph TB
    A[ä¿ç•™æ‰€æœ‰å†å²çŠ¶æ€]
    B[æ¯ä¸ªåŒºå—çš„çŠ¶æ€éƒ½å¯æŸ¥è¯¢]
    C[ç”¨äºåŒºå—æµè§ˆå™¨ã€åˆ†æ]
    D[å­˜å‚¨ç©ºé—´: ~12TB+]

    A --> B --> C --> D

    style A fill:#ffcdd2
    style D fill:#f44336
```

**å¯¹æ¯”ï¼š**

| ç‰¹æ€§     | ä¿®å‰ªèŠ‚ç‚¹    | å½’æ¡£èŠ‚ç‚¹ |
| -------- | ----------- | -------- |
| å­˜å‚¨éœ€æ±‚ | ~500GB      | ~12TB    |
| å†å²æŸ¥è¯¢ | æœ€è¿‘ 128 å— | æ‰€æœ‰å†å² |
| åŒæ­¥é€Ÿåº¦ | å¿«          | æ…¢       |
| ç”¨é€”     | æ—¥å¸¸ä½¿ç”¨    | å†å²åˆ†æ |

---

## å…±è¯†æœºåˆ¶

### 1. PoW åˆ° PoS çš„æ¼”å˜

#### å†å²æ—¶é—´çº¿

```mermaid
timeline
    title ä»¥å¤ªåŠå…±è¯†æœºåˆ¶æ¼”å˜

    2015-07 : ä¸»ç½‘å¯åŠ¨<br/>PoW (Ethash)
            : çŸ¿å·¥ç«äº‰æŒ–çŸ¿

    2020-12 : ä¿¡æ ‡é“¾å¯åŠ¨<br/>PoSå¹¶è¡Œè¿è¡Œ
            : éªŒè¯è€…å¼€å§‹è´¨æŠ¼

    2022-09 : The Merge<br/>å®Œå…¨è½¬å‘PoS
            : èƒ½è€—é™ä½99.95%

    2023-04 : Shanghaiå‡çº§<br/>æ”¯æŒææ¬¾
            : è´¨æŠ¼ETHå¯å–å‡º
```

#### PoW vs PoS å¯¹æ¯”

```mermaid
graph TB
    subgraph "PoW å·¥ä½œé‡è¯æ˜"
        POW1[ç®—åŠ›ç«äº‰]
        POW2[èƒ½æºå¯†é›†]
        POW3[ç¡¬ä»¶å†›å¤‡ç«èµ›]
        POW4[51%æ”»å‡»æˆæœ¬=ç®—åŠ›]

        POW1 --> POW2 --> POW3 --> POW4
    end

    subgraph "PoS æƒç›Šè¯æ˜"
        POS1[è´¨æŠ¼ç«äº‰]
        POS2[èƒ½æºå‹å¥½]
        POS3[ç»æµé—¨æ§›]
        POS4[51%æ”»å‡»æˆæœ¬=èµ„æœ¬]

        POS1 --> POS2 --> POS3 --> POS4
    end

    style POW1 fill:#ffcdd2
    style POW2 fill:#ef9a9a
    style POW3 fill:#e57373
    style POW4 fill:#f44336
    style POS1 fill:#c8e6c9
    style POS2 fill:#a5d6a7
    style POS3 fill:#81c784
    style POS4 fill:#4caf50
```

**è¯¦ç»†å¯¹æ¯”ï¼š**

| ç‰¹æ€§           | PoW              | PoS                   |
| -------------- | ---------------- | --------------------- |
| **èƒ½æºæ¶ˆè€—**   | ~100 TWh/å¹´      | ~0.01 TWh/å¹´ â¬‡ï¸99.95% |
| **ç¡¬ä»¶éœ€æ±‚**   | ä¸“ç”¨çŸ¿æœº         | æ™®é€šæœåŠ¡å™¨            |
| **å‚ä¸é—¨æ§›**   | é«˜ï¼ˆè®¾å¤‡+ç”µè´¹ï¼‰  | ä¸­ï¼ˆ32 ETH è´¨æŠ¼ï¼‰     |
| **åŒºå—æ—¶é—´**   | ~13.5 ç§’ï¼ˆå¯å˜ï¼‰ | ~12 ç§’ï¼ˆå›ºå®šï¼‰        |
| **æœ€ç»ˆç¡®å®šæ€§** | ~6-30 åˆ†é’Ÿ       | ~13 åˆ†é’Ÿï¼ˆ2 Epochï¼‰   |
| **51%æ”»å‡»**    | éœ€æ§åˆ¶ 51%ç®—åŠ›   | éœ€æ§åˆ¶ 51%è´¨æŠ¼+è¢«æƒ©ç½š |
| **ç¯å¢ƒå½±å“**   | å·¨å¤§             | æå°                  |
| **ä¸­å¿ƒåŒ–é£é™©** | çŸ¿æ± é›†ä¸­         | å¤§æˆ·é›†ä¸­ï¼ˆä½†å¯æƒ©ç½šï¼‰  |

### 2. PoS å·¥ä½œæœºåˆ¶

#### Epoch å’Œ Slot

```mermaid
gantt
    title 1ä¸ªEpoch = 32ä¸ªSlots
    dateFormat YYYY-MM-DD HH:mm:ss
    axisFormat %M:%S

    section Slots
    Slot 0  : 2024-01-01 00:00:00, 12s
    Slot 1  : 2024-01-01 00:00:12, 12s
    Slot 2  : 2024-01-01 00:00:24, 12s
    Slot 3  : 2024-01-01 00:00:36, 12s
    ...     : 2024-01-01 00:00:48, 4m
    Slot 31 : 2024-01-01 00:06:12, 12s

    section Epoch
    Epoch 1 : 2024-01-01 00:00:00, 6m24s
```

**æ—¶é—´å•ä½ï¼š**

```
1 Slot = 12ç§’
1 Epoch = 32 Slots = 384ç§’ â‰ˆ 6.4åˆ†é’Ÿ

æ¯ä¸ªSlot:
- 1ä¸ªéªŒè¯è€…è¢«é€‰ä¸ºæè®®è€…ï¼ˆProposerï¼‰
- å…¶ä»–éªŒè¯è€…ç»„æˆå§”å‘˜ä¼šï¼ˆCommitteeï¼‰æŠ•ç¥¨
```

#### éªŒè¯è€…ç”Ÿå‘½å‘¨æœŸ

```mermaid
stateDiagram-v2
    [*] --> å­˜å…¥: è´¨æŠ¼32 ETH
    å­˜å…¥ --> æ¿€æ´»é˜Ÿåˆ—: ç­‰å¾…æ¿€æ´»
    æ¿€æ´»é˜Ÿåˆ— --> æ´»è·ƒ: å¼€å§‹éªŒè¯

    æ´»è·ƒ --> æè®®è€…: è¢«é€‰ä¸­æè®®åŒºå—
    æ´»è·ƒ --> è¯æ˜è€…: å§”å‘˜ä¼šæˆå‘˜æŠ•ç¥¨

    æè®®è€… --> æ´»è·ƒ: å®Œæˆæè®®
    è¯æ˜è€… --> æ´»è·ƒ: å®ŒæˆæŠ•ç¥¨

    æ´»è·ƒ --> é€€å‡ºé˜Ÿåˆ—: ä¸»åŠ¨é€€å‡º
    æ´»è·ƒ --> Slashed: æ¶æ„è¡Œä¸º

    é€€å‡ºé˜Ÿåˆ— --> å·²é€€å‡º: ç­‰å¾…æœŸç»“æŸ
    Slashed --> å·²é€€å‡º: è¢«æƒ©ç½š

    å·²é€€å‡º --> [*]: å–å›ETH
```

#### åŒºå—æè®®è¿‡ç¨‹

```mermaid
sequenceDiagram
    participant V1 as æè®®è€…<br/>éªŒè¯è€…1
    participant V2 as è¯æ˜è€…<br/>éªŒè¯è€…2-N
    participant N as ç½‘ç»œ
    participant BC as åŒºå—é“¾

    Note over V1: Slot Nå¼€å§‹
    V1->>V1: 1. é€‰æ‹©äº¤æ˜“
    V1->>V1: 2. æ‰§è¡Œäº¤æ˜“
    V1->>V1: 3. æ„å»ºåŒºå—
    V1->>N: 4. å¹¿æ’­åŒºå—

    N->>V2: 5. åˆ†å‘åŒºå—
    activate V2
    V2->>V2: 6. éªŒè¯åŒºå—
    V2->>V2: 7. æŠ•ç¥¨(Attestation)
    V2->>N: 8. å¹¿æ’­æŠ•ç¥¨
    deactivate V2

    N->>BC: 9. æ”¶é›†æŠ•ç¥¨

    alt è·å¾—2/3+æŠ•ç¥¨
        BC->>BC: 10. åŒºå—è¢«æ¥å—
        Note over BC: çŠ¶æ€æ›´æ–°
    else æŠ•ç¥¨ä¸è¶³
        BC->>BC: 11. åŒºå—è¢«æ‹’ç»
        Note over BC: ä¿æŒåŸçŠ¶æ€
    end
```

### 3. å¥–åŠ±ä¸æƒ©ç½šæœºåˆ¶

#### å¥–åŠ±ç»“æ„

```mermaid
graph TB
    R[éªŒè¯è€…å¥–åŠ±]

    R1[åŸºç¡€å¥–åŠ±<br/>æ¯ä¸ªEpoch]
    R2[æè®®è€…å¥–åŠ±<br/>æˆåŠŸæè®®åŒºå—]
    R3[åŒæ­¥å§”å‘˜ä¼š<br/>å‚ä¸åŒæ­¥]
    R4[äº¤æ˜“å°è´¹<br/>Priority Fee]

    R --> R1
    R --> R2
    R --> R3
    R --> R4

    style R fill:#c8e6c9
    style R1 fill:#81c784
    style R2 fill:#66bb6a
    style R3 fill:#4caf50
    style R4 fill:#43a047
```

**å¥–åŠ±è¯¦æƒ…ï¼š**

```
åŸºç¡€å¥–åŠ± (Base Reward):
- æ¯ä¸ªEpochç»™æ‰€æœ‰æ´»è·ƒéªŒè¯è€…
- å–å†³äºæ€»è´¨æŠ¼é‡
- å¹´åŒ–æ”¶ç›Šç‡: ~3-5%

æè®®è€…å¥–åŠ± (Proposer Reward):
- æˆåŠŸæè®®åŒºå—æ—¶è·å¾—
- çº¦ä¸ºåŸºç¡€å¥–åŠ±çš„1/8
- åŒ…å«attestationsçš„å°è´¹

åŒæ­¥å§”å‘˜ä¼šå¥–åŠ±:
- éšæœºé€‰ä¸­å‚ä¸åŒæ­¥å§”å‘˜ä¼š
- é¢å¤–å¥–åŠ±

äº¤æ˜“å°è´¹ (Tips):
- EIP-1559çš„Priority Fee
- å®Œå…¨å½’éªŒè¯è€…æ‰€æœ‰
```

#### æƒ©ç½šæœºåˆ¶

```mermaid
graph TB
    P[æƒ©ç½šç±»å‹]

    P1[ç¦»çº¿ç½šæ¬¾<br/>Inactivity Leak]
    P2[é”™è¯¯è¯æ˜<br/>Minor Penalty]
    P3[Slashing<br/>ä¸¥é‡æƒ©ç½š]

    P --> P1
    P --> P2
    P --> P3

    D1[è½»å¾®<br/>-å°‘é‡å¥–åŠ±]
    D2[ä¸­ç­‰<br/>-åŸºç¡€å¥–åŠ±]
    D3[ä¸¥é‡<br/>-å¤§é‡è´¨æŠ¼ç”šè‡³å…¨éƒ¨]

    P1 --> D1
    P2 --> D2
    P3 --> D3

    style P fill:#ffcdd2
    style P1 fill:#ef9a9a
    style P2 fill:#e57373
    style P3 fill:#f44336
    style D1 fill:#fff9c4
    style D2 fill:#ffcc80
    style D3 fill:#ff6f00
```

**Slashing è§¦å‘æ¡ä»¶ï¼š**

```
1. åŒé‡ç­¾å (Double Signing):
   - å¯¹åŒä¸€Slotæè®®ä¸¤ä¸ªä¸åŒåŒºå—
   - æƒ©ç½š: æŸå¤±1 ETH + è¢«å¼ºåˆ¶é€€å‡º

2. ç¯ç»•æŠ•ç¥¨ (Surround Vote):
   - æŠ•ç¥¨åŒ…å›´ä¹‹å‰çš„æŠ•ç¥¨
   - è¯•å›¾æ”¹å†™å†å²
   - æƒ©ç½š: æŸå¤±è‡³å°‘1 ETH

3. åŒé‡æŠ•ç¥¨ (Double Vote):
   - å¯¹åŒä¸€ç›®æ ‡è¿›è¡Œä¸¤æ¬¡ä¸åŒæŠ•ç¥¨
   - æƒ©ç½š: æŸå¤±è‡³å°‘1 ETH

ä¸¥é‡æƒ…å†µ:
- å¦‚æœåŒæ—¶æœ‰å¾ˆå¤šéªŒè¯è€…è¢«slash
- ç›¸å…³æƒ©ç½šä¼šåŠ é‡ï¼ˆæœ€é«˜å¯æŸå¤±å…¨éƒ¨32 ETHï¼‰
```

### 4. æœ€ç»ˆç¡®å®šæ€§

#### Casper FFGï¼ˆå‹å¥½çš„æœ€ç»ˆæ€§å·¥å…·ï¼‰

```mermaid
graph LR
    B1[åŒºå—N] --> B2[åŒºå—N+1]
    B2 --> B3[åŒºå—N+2]

    B3 --> J1[Justified<br/>åˆç†åŒ–]
    J1 --> J2[+1 Epoch]
    J2 --> F1[Finalized<br/>æœ€ç»ˆç¡®å®š]

    style B1 fill:#e3f2fd
    style B2 fill:#bbdefb
    style B3 fill:#90caf9
    style J1 fill:#fff9c4
    style J2 fill:#ffcc80
    style F1 fill:#c8e6c9
```

**ç¡®å®šæ€§æµç¨‹ï¼š**

```
Slot N: åŒºå—æè®®
    â†“
ç­‰å¾…2/3+éªŒè¯è€…æŠ•ç¥¨
    â†“
Checkpoint N: Justifiedï¼ˆåˆç†åŒ–ï¼‰
    â†“
ç­‰å¾…ä¸‹ä¸€ä¸ªEpochï¼ˆ32 slotsï¼‰
    â†“
Checkpoint N+1: ä¹Ÿè¢«Justified
    â†“
Checkpoint N: Finalizedï¼ˆæœ€ç»ˆç¡®å®šï¼‰
    â†“
æ°¸ä¹…ä¸å¯é€†ï¼

æ€»æ—¶é—´: çº¦12.8åˆ†é’Ÿï¼ˆ2ä¸ªEpochï¼‰
```

#### æœ€ç»ˆç¡®å®šæ€§å¯è§†åŒ–

```mermaid
gantt
    title åŒºå—æœ€ç»ˆç¡®å®šæ—¶é—´çº¿
    dateFormat YYYY-MM-DD HH:mm:ss
    axisFormat %M:%S

    section æè®®
    åŒºå—Næè®®     : 2024-01-01 00:00:00, 12s

    section Epoch 1
    æ”¶é›†æŠ•ç¥¨      : 2024-01-01 00:00:12, 372s
    Justified     : 2024-01-01 00:06:24, 1s

    section Epoch 2
    ç»§ç»­ç¡®è®¤      : 2024-01-01 00:06:25, 383s
    Finalized     : 2024-01-01 00:12:48, 1s
```

---

## å®è·µç»ƒä¹ 

### ç»ƒä¹  1ï¼šè¿è¡Œæœ¬åœ°èŠ‚ç‚¹

**ç›®æ ‡ï¼š** ä½“éªŒèŠ‚ç‚¹åŒæ­¥è¿‡ç¨‹

**æ­¥éª¤ï¼š**

```bash
# 1. å®‰è£…Gethï¼ˆæ‰§è¡Œå±‚å®¢æˆ·ç«¯ï¼‰
# macOS
brew install ethereum

# Ubuntu
sudo add-apt-repository ppa:ethereum/ethereum
sudo apt-get update
sudo apt-get install ethereum

# 2. å¯åŠ¨èŠ‚ç‚¹ï¼ˆSepoliaæµ‹è¯•ç½‘ï¼‰
geth --sepolia --http --http.api eth,net,web3

# 3. æ£€æŸ¥åŒæ­¥çŠ¶æ€
geth attach http://localhost:8545
> eth.syncing
> eth.blockNumber

# 4. æŸ¥çœ‹è¿æ¥çš„èŠ‚ç‚¹
> admin.peers
```

### ç»ƒä¹  2ï¼šåˆ†æåŒºå—ç»“æ„

**ä½¿ç”¨ Etherscanï¼š**

1. è®¿é—® https://etherscan.io/blocks
2. ç‚¹å‡»æœ€æ–°åŒºå—
3. è§‚å¯ŸåŒºå—ä¿¡æ¯ï¼š
   - Block Heightï¼ˆåŒºå—å·ï¼‰
   - Timestampï¼ˆæ—¶é—´æˆ³ï¼‰
   - Transactionsï¼ˆäº¤æ˜“æ•°ï¼‰
   - Gas Usedï¼ˆGas ä½¿ç”¨ï¼‰
   - Base Feeï¼ˆåŸºç¡€è´¹ç”¨ï¼‰

**ä½¿ç”¨ Web3.jsï¼š**

```javascript
const Web3 = require('web3');
const web3 = new Web3('https://mainnet.infura.io/v3/YOUR_KEY');

// è·å–æœ€æ–°åŒºå—
web3.eth.getBlock('latest').then(console.log);

// è·å–æŒ‡å®šåŒºå—
web3.eth.getBlock(18000000).then((block) => {
  console.log('åŒºå—å·:', block.number);
  console.log('æ—¶é—´æˆ³:', block.timestamp);
  console.log('äº¤æ˜“æ•°:', block.transactions.length);
  console.log('Gasä½¿ç”¨:', block.gasUsed);
  console.log('çŸ¿å·¥/éªŒè¯è€…:', block.miner);
});
```

### ç»ƒä¹  3ï¼šæ¢ç´¢çŠ¶æ€æ ‘

**ä½¿ç”¨ Geth Debug APIï¼š**

```javascript
// è·å–è´¦æˆ·çŠ¶æ€
geth attach http://localhost:8545

> debug.traceTransaction("0xTxHash", {tracer: "prestateTracer"})

// æŸ¥çœ‹Storageå˜åŒ–
> debug.storageRangeAt(
    "0xBlockHash",
    0, // transaction index
    "0xContractAddress",
    "0x0000000000000000000000000000000000000000000000000000000000000000",
    1024
)
```

### ç»ƒä¹  4ï¼šç›‘æ§ç½‘ç»œçŠ¶æ€

**ä½¿ç”¨å…¬å¼€ç›‘æ§å·¥å…·ï¼š**

1. **Ethernodes**

   - https://ethernodes.org/
   - æŸ¥çœ‹å…¨çƒèŠ‚ç‚¹åˆ†å¸ƒ

2. **Etherscan Node Tracker**

   - https://etherscan.io/nodetracker
   - å®¢æˆ·ç«¯åˆ†å¸ƒç»Ÿè®¡

3. **Beaconcha.in**
   - https://beaconcha.in/
   - PoS éªŒè¯è€…ç»Ÿè®¡
   - Epoch å’Œ Slot å®æ—¶ä¿¡æ¯

---

## å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

1. **Ethereum.org - Architecture**

   - https://ethereum.org/en/developers/docs/ethereum-stack/
   - å®Œæ•´æŠ€æœ¯æ ˆæ–‡æ¡£

2. **Ethereum Yellow Paper**

   - https://ethereum.github.io/yellowpaper/paper.pdf
   - ä»¥å¤ªåŠæŠ€æœ¯è§„èŒƒ

3. **Consensus Specs**

   - https://github.com/ethereum/consensus-specs
   - PoS å…±è¯†è§„èŒƒ

4. **Execution Specs**
   - https://github.com/ethereum/execution-specs
   - æ‰§è¡Œå±‚è§„èŒƒ

### æ¶æ„æ·±å…¥

5. **The Merge Documentation**

   - https://ethereum.org/en/roadmap/merge/
   - åˆå¹¶æŠ€æœ¯è¯¦æƒ…

6. **State Trie Pruning**

   - https://blog.ethereum.org/2015/06/26/state-tree-pruning
   - çŠ¶æ€ä¿®å‰ªåŸç†

7. **Merkle Patricia Trie Specification**
   - https://ethereum.org/en/developers/docs/data-structures-and-encoding/patricia-merkle-trie/
   - MPT è¯¦ç»†è¯´æ˜

### å®¢æˆ·ç«¯èµ„æº

8. **Geth Documentation**

   - https://geth.ethereum.org/docs
   - Go-Ethereum æ–‡æ¡£

9. **Erigon GitHub**

   - https://github.com/ledgerwatch/erigon
   - é«˜æ•ˆå®¢æˆ·ç«¯å®ç°

10. **Prysm Documentation**

    - https://docs.prylabs.network/
    - å…±è¯†å±‚å®¢æˆ·ç«¯

11. **Lighthouse Book**
    - https://lighthouse-book.sigmaprime.io/
    - Rust å…±è¯†å®¢æˆ·ç«¯

### å…±è¯†æœºåˆ¶

12. **Proof of Stake FAQ**

    - https://eth2book.info/
    - PoS å¸¸è§é—®é¢˜

13. **Casper FFG Paper**

    - https://arxiv.org/abs/1710.09437
    - æœ€ç»ˆæ€§è®ºæ–‡

14. **Gasper Paper**
    - https://arxiv.org/abs/2003.03052
    - å®Œæ•´å…±è¯†åè®®

### ç½‘ç»œå±‚

15. **devp2p Specifications**

    - https://github.com/ethereum/devp2p
    - P2P åè®®è§„èŒƒ

16. **libp2p Documentation**
    - https://docs.libp2p.io/
    - å…±è¯†å±‚ç½‘ç»œåº“

### å·¥å…·å’Œç›‘æ§

17. **Ethernodes**

    - https://ethernodes.org/
    - èŠ‚ç‚¹ç»Ÿè®¡

18. **Beaconcha.in**

    - https://beaconcha.in/
    - ä¿¡æ ‡é“¾æµè§ˆå™¨

19. **Etherscan**

    - https://etherscan.io/
    - åŒºå—é“¾æµè§ˆå™¨

20. **Grafana Dashboards**
    - https://github.com/ethereum/node-crawler/tree/master/dashboards
    - èŠ‚ç‚¹ç›‘æ§é¢æ¿

### å­¦ä¹ èµ„æº

21. **Mastering Ethereum**

    - https://github.com/ethereumbook/ethereumbook
    - å¼€æºä¹¦ç±

22. **Ethereum StackExchange**

    - https://ethereum.stackexchange.com/
    - é—®ç­”ç¤¾åŒº

23. **EthResearch**

    - https://ethresear.ch/
    - ç ”ç©¶è®ºå›

24. **Week in Ethereum News**
    - https://weekinethereumnews.com/
    - æ¯å‘¨æ›´æ–°

### è§†é¢‘æ•™ç¨‹

25. **Finematics - Ethereum 2.0**

    - https://www.youtube.com/c/Finematics
    - åŠ¨ç”»è§£é‡Š

26. **Vitalik Buterin Talks**
    - https://www.youtube.com/@VitalikButerin
    - åˆ›å§‹äººæ¼”è®²

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

**ä»¥å¤ªåŠæ¶æ„çš„æ ¸å¿ƒï¼š**

```
âœ… åŒå±‚æ¶æ„
   - æ‰§è¡Œå±‚ï¼šå¤„ç†äº¤æ˜“å’Œæ™ºèƒ½åˆçº¦
   - å…±è¯†å±‚ï¼šPoSéªŒè¯å’Œæœ€ç»ˆç¡®å®š

âœ… ä¸¤ç§è´¦æˆ·
   - EOAï¼šç”¨æˆ·æ§åˆ¶
   - åˆçº¦ï¼šä»£ç æ§åˆ¶

âœ… ä¸‰ç§Trie
   - State Trieï¼šå…¨å±€çŠ¶æ€
   - Storage Trieï¼šåˆçº¦å­˜å‚¨
   - Transactions Trieï¼šäº¤æ˜“è®°å½•

âœ… å››ç§èŠ‚ç‚¹
   - å…¨èŠ‚ç‚¹ï¼šå®Œæ•´éªŒè¯
   - è½»èŠ‚ç‚¹ï¼šä¾èµ–éªŒè¯
   - å½’æ¡£èŠ‚ç‚¹ï¼šå†å²æŸ¥è¯¢
   - éªŒè¯è€…ï¼šå‚ä¸å…±è¯†

âœ… PoSå…±è¯†
   - Slot/Epochæœºåˆ¶
   - å¥–åŠ±å’Œæƒ©ç½š
   - æœ€ç»ˆç¡®å®šæ€§
```

### å­¦ä¹ è·¯å¾„

**åˆå­¦è€…ï¼š**

1. ç†è§£è´¦æˆ·å’Œäº¤æ˜“æ¦‚å¿µ
2. ä½¿ç”¨ Etherscan æŸ¥çœ‹åŒºå—
3. è¿è¡Œè½»èŠ‚ç‚¹ä½“éªŒ
4. äº†è§£ PoS åŸºæœ¬åŸç†

**è¿›é˜¶ï¼š**

1. æ·±å…¥ MPT æ•°æ®ç»“æ„
2. ç ”ç©¶å…±è¯†åè®®ç»†èŠ‚
3. è¿è¡Œå…¨èŠ‚ç‚¹
4. å‚ä¸æµ‹è¯•ç½‘éªŒè¯

**é«˜çº§ï¼š**

1. é˜…è¯»ä»¥å¤ªåŠé»„çš®ä¹¦
2. è´¡çŒ®å®¢æˆ·ç«¯ä»£ç 
3. ç ”ç©¶ MEV å’Œ Layer 2
4. å‚ä¸åè®®æ”¹è¿›ææ¡ˆ

### æœªæ¥å±•æœ›

**ä»¥å¤ªåŠè·¯çº¿å›¾ï¼š**

```mermaid
timeline
    title ä»¥å¤ªåŠæœªæ¥å‘å±•

    2024 : Dencunå‡çº§<br/>Blobäº¤æ˜“
         : Layer 2æˆæœ¬é™ä½

    2025-26 : Verkleæ ‘<br/>æ›¿ä»£MPT
            : æ›´é«˜æ•ˆçš„çŠ¶æ€å­˜å‚¨

    2026-27 : åˆ†ç‰‡<br/>Sharding
            : æ•°æ®å¯ç”¨æ€§åˆ†ç‰‡

    2027+ : å•æ§½æœ€ç»ˆç¡®å®š<br/>SSF
          : æ›´å¿«çš„ç¡®è®¤æ—¶é—´
```

**æŒç»­æ”¹è¿›ï¼š**

- é™ä½éªŒè¯è€…é—¨æ§›ï¼ˆ< 32 ETHï¼‰
- æé«˜ååé‡
- ä¼˜åŒ–å­˜å‚¨æ•ˆç‡
- å¢å¼ºéšç§åŠŸèƒ½

---

**æ­å–œå®Œæˆå­¦ä¹ ï¼** ğŸ‰

ä½ ç°åœ¨åº”è¯¥å¯¹ä»¥å¤ªåŠçš„æ•´ä½“æ¶æ„æœ‰äº†æ·±å…¥ç†è§£ã€‚ç»§ç»­å­¦ä¹ ä¸‹ä¸€éƒ¨åˆ†ã€ŠEVM å·¥ä½œåŸç†ã€‹ï¼Œæ·±å…¥äº†è§£æ™ºèƒ½åˆçº¦çš„æ‰§è¡Œæœºåˆ¶ï¼

_æœ€åæ›´æ–°ï¼š2025 å¹´ 11 æœˆ_
_ç¥ä½ åœ¨åŒºå—é“¾ä¸–ç•Œæ¢ç´¢æ„‰å¿«ï¼ğŸš€_
